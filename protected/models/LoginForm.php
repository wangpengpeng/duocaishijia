<?php/** * LoginForm class. * LoginForm is the data structure for keeping * user login form data. It is used by the 'login' action of 'SiteController'. */class LoginForm extends CFormModel{	public $username;	public $password;	public $rememberMe;	private $_identity;	/**	 * Declares the validation rules.	 * The rules state that username and password are required,	 * and password needs to be authenticated.	 */	public function rules()	{		return array(			// username and password are required			array('username, password', 'required'),			// rememberMe needs to be a boolean			array('rememberMe', 'boolean'),			// password needs to be authenticated			array('password', 'authenticate'),		);	}	/**	 * Declares attribute labels.	 */	public function attributeLabels()	{		return array(                        'username'=>'用户名',                        'password'=>'密码',			'rememberMe'=>'下次记住我',		);	}	/**	 * Authenticates the password.	 * This is the 'authenticate' validator as declared in rules().	 */	public function authenticate($attribute,$params)	{	var_dump(112);		if(!$this->hasErrors())		{			$this->_identity=new UserIdentity($this->username,$this->password);			if(!$this->_identity->authenticate())				$this->addError('password','Incorrect username or password.');		}	}	/**	 * Logs in the user using the given username and password in the model.	 * @return boolean whether login is successful	 */	public function login()	{		if($this->_identity===null)		{	var_dump(11);			$this->_identity= new UserIdentity($this->username,$this->password);			var_dump($this->_identity );			$this->_identity->authenticate();			var_dump(221);		}		var_dump(123);		if($this->_identity->errorCode===UserIdentity::ERROR_NONE)		{	 dump(133);			$duration=$this->rememberMe ? 3600*24*30 : 0; // 30 days			Yii::app()->user->login($this->_identity,$duration);			return true;		}		else			return false;	}}